<!--
// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.
-->
    
<UserControl 
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
  xmlns:toolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
  xmlns:common="clr-namespace:System.Windows;assembly=System.Windows.Controls"
  x:Class="System.Windows.Controls.Samples.TreeViewTemplatingSample">
    <StackPanel>
        <toolkit:WrapPanel>
            <toolkit:WrapPanel.Resources>
                <ResourceDictionary>
                    <ResourceDictionary.MergedDictionaries>
                        <ResourceDictionary Source="/TreeView/Templating/TreeViewDefault.xaml" />
                        <ResourceDictionary Source="/TreeView/Templating/TreeViewFullRowSelect.xaml" />
                        <ResourceDictionary Source="/TreeView/Templating/TreeViewConnectingLines.xaml" />
                        <ResourceDictionary Source="/TreeView/Templating/TreeViewCheckBoxes.xaml" />
                    </ResourceDictionary.MergedDictionaries>
                </ResourceDictionary>
            </toolkit:WrapPanel.Resources>
            
            <!-- Default with MouseWheel -->
            <StackPanel Margin="10">
                <TextBlock Text="Default with MouseWheel:" />
                <controls:TreeView
                  x:Name="TreeDefault"
                  Width="300"
                  Height="300"
                  Style="{StaticResource DefaultTreeView}"
                  ItemContainerStyle="{StaticResource DefaultTreeViewItem}">
                    <controls:TreeView.ItemTemplate>
                        <common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource DefaultTreeViewItem}">
                            <TextBlock Text="{Binding Classification}" />
                        </common:HierarchicalDataTemplate>
                    </controls:TreeView.ItemTemplate>
                </controls:TreeView>
                <Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeDefault}"
                  HorizontalAlignment="Left"
                  Margin="2" />
            </StackPanel>
            
            <!-- Full Row Select -->
            <StackPanel Margin="10">
                <TextBlock Text="Full Row Select:" />
                <controls:TreeView
                  x:Name="TreeFullRow"
                  Width="300"
                  Height="300"
                  Style="{StaticResource FullRowSelectTreeView}"
                  ItemContainerStyle="{StaticResource FullRowSelectTreeViewItem}">
                    <controls:TreeView.ItemTemplate>
                        <common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource FullRowSelectTreeViewItem}">
                            <TextBlock Text="{Binding Classification}" />
                        </common:HierarchicalDataTemplate>
                    </controls:TreeView.ItemTemplate>
                </controls:TreeView>
                <Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeFullRow}"
                  HorizontalAlignment="Left"
                  Margin="2" />
            </StackPanel>
            
            <!-- Connecting Lines -->
            <StackPanel Margin="10">
                <TextBlock Text="Connecting Lines:" />
                <controls:TreeView
                  x:Name="TreeLines"
                  Width="300"
                  Height="300"
                  Style="{StaticResource ConnectingLinesTreeView}"
                  ItemContainerStyle="{StaticResource ConnectingLinesTreeViewItem}">
                    <controls:TreeView.ItemTemplate>
                        <common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource ConnectingLinesTreeViewItem}">
                            <TextBlock Text="{Binding Classification}" />
                        </common:HierarchicalDataTemplate>
                    </controls:TreeView.ItemTemplate>
                </controls:TreeView>
                <Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeLines}"
                  HorizontalAlignment="Left"
                  Margin="2" />
            </StackPanel>
            
            <!-- CheckBoxes -->
            <StackPanel Margin="10">
                <TextBlock Text="CheckBoxes:" />
                <controls:TreeView
                  x:Name="TreeCheckBox"
                  Width="300"
                  Height="300"
                  Style="{StaticResource CheckBoxTreeView}"
                  ItemContainerStyle="{StaticResource CheckBoxTreeViewItem}">
                    <controls:TreeView.ItemTemplate>
                        <common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource CheckBoxTreeViewItem}">
                            <TextBlock Text="{Binding Classification}" />
                        </common:HierarchicalDataTemplate>
                    </controls:TreeView.ItemTemplate>
                </controls:TreeView>
                <Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeCheckBox}"
                  HorizontalAlignment="Left"
                  Margin="2" />
            </StackPanel>
        </toolkit:WrapPanel>

        <src:SourceViewer xmlns:src="clr-namespace:System.Windows.Controls.Samples;assembly=System.Windows.Controls.Samples.Common" xmlns:sys="clr-namespace:System;assembly=mscorlib">
  <src:SourceFile Path="TreeViewTemplatingSample.xaml">
    <src:SourceFile.Source>
      <sys:String xml:space="preserve">&lt;!--
// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.
--&gt;
    
&lt;UserControl 
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
  xmlns:toolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
  xmlns:common="clr-namespace:System.Windows;assembly=System.Windows.Controls"
  x:Class="System.Windows.Controls.Samples.TreeViewTemplatingSample"&gt;
    &lt;StackPanel&gt;
        &lt;toolkit:WrapPanel&gt;
            &lt;toolkit:WrapPanel.Resources&gt;
                &lt;ResourceDictionary&gt;
                    &lt;ResourceDictionary.MergedDictionaries&gt;
                        &lt;ResourceDictionary Source="/TreeView/Templating/TreeViewDefault.xaml" /&gt;
                        &lt;ResourceDictionary Source="/TreeView/Templating/TreeViewFullRowSelect.xaml" /&gt;
                        &lt;ResourceDictionary Source="/TreeView/Templating/TreeViewConnectingLines.xaml" /&gt;
                        &lt;ResourceDictionary Source="/TreeView/Templating/TreeViewCheckBoxes.xaml" /&gt;
                    &lt;/ResourceDictionary.MergedDictionaries&gt;
                &lt;/ResourceDictionary&gt;
            &lt;/toolkit:WrapPanel.Resources&gt;
            
            &lt;!-- Default with MouseWheel --&gt;
            &lt;StackPanel Margin="10"&gt;
                &lt;TextBlock Text="Default with MouseWheel:" /&gt;
                &lt;controls:TreeView
                  x:Name="TreeDefault"
                  Width="300"
                  Height="300"
                  Style="{StaticResource DefaultTreeView}"
                  ItemContainerStyle="{StaticResource DefaultTreeViewItem}"&gt;
                    &lt;controls:TreeView.ItemTemplate&gt;
                        &lt;common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource DefaultTreeViewItem}"&gt;
                            &lt;TextBlock Text="{Binding Classification}" /&gt;
                        &lt;/common:HierarchicalDataTemplate&gt;
                    &lt;/controls:TreeView.ItemTemplate&gt;
                &lt;/controls:TreeView&gt;
                &lt;Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeDefault}"
                  HorizontalAlignment="Left"
                  Margin="2" /&gt;
            &lt;/StackPanel&gt;
            
            &lt;!-- Full Row Select --&gt;
            &lt;StackPanel Margin="10"&gt;
                &lt;TextBlock Text="Full Row Select:" /&gt;
                &lt;controls:TreeView
                  x:Name="TreeFullRow"
                  Width="300"
                  Height="300"
                  Style="{StaticResource FullRowSelectTreeView}"
                  ItemContainerStyle="{StaticResource FullRowSelectTreeViewItem}"&gt;
                    &lt;controls:TreeView.ItemTemplate&gt;
                        &lt;common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource FullRowSelectTreeViewItem}"&gt;
                            &lt;TextBlock Text="{Binding Classification}" /&gt;
                        &lt;/common:HierarchicalDataTemplate&gt;
                    &lt;/controls:TreeView.ItemTemplate&gt;
                &lt;/controls:TreeView&gt;
                &lt;Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeFullRow}"
                  HorizontalAlignment="Left"
                  Margin="2" /&gt;
            &lt;/StackPanel&gt;
            
            &lt;!-- Connecting Lines --&gt;
            &lt;StackPanel Margin="10"&gt;
                &lt;TextBlock Text="Connecting Lines:" /&gt;
                &lt;controls:TreeView
                  x:Name="TreeLines"
                  Width="300"
                  Height="300"
                  Style="{StaticResource ConnectingLinesTreeView}"
                  ItemContainerStyle="{StaticResource ConnectingLinesTreeViewItem}"&gt;
                    &lt;controls:TreeView.ItemTemplate&gt;
                        &lt;common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource ConnectingLinesTreeViewItem}"&gt;
                            &lt;TextBlock Text="{Binding Classification}" /&gt;
                        &lt;/common:HierarchicalDataTemplate&gt;
                    &lt;/controls:TreeView.ItemTemplate&gt;
                &lt;/controls:TreeView&gt;
                &lt;Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeLines}"
                  HorizontalAlignment="Left"
                  Margin="2" /&gt;
            &lt;/StackPanel&gt;
            
            &lt;!-- CheckBoxes --&gt;
            &lt;StackPanel Margin="10"&gt;
                &lt;TextBlock Text="CheckBoxes:" /&gt;
                &lt;controls:TreeView
                  x:Name="TreeCheckBox"
                  Width="300"
                  Height="300"
                  Style="{StaticResource CheckBoxTreeView}"
                  ItemContainerStyle="{StaticResource CheckBoxTreeViewItem}"&gt;
                    &lt;controls:TreeView.ItemTemplate&gt;
                        &lt;common:HierarchicalDataTemplate
                          ItemsSource="{Binding Subclasses}"
                          ItemContainerStyle="{StaticResource CheckBoxTreeViewItem}"&gt;
                            &lt;TextBlock Text="{Binding Classification}" /&gt;
                        &lt;/common:HierarchicalDataTemplate&gt;
                    &lt;/controls:TreeView.ItemTemplate&gt;
                &lt;/controls:TreeView&gt;
                &lt;Button
                  Content="Expand All"
                  Click="OnExpandAll"
                  Tag="{Binding ElementName=TreeCheckBox}"
                  HorizontalAlignment="Left"
                  Margin="2" /&gt;
            &lt;/StackPanel&gt;
        &lt;/toolkit:WrapPanel&gt;
    &lt;/StackPanel&gt;
&lt;/UserControl&gt;</sys:String>
    </src:SourceFile.Source>
  </src:SourceFile>
  <src:SourceFile Path="TreeViewTemplatingSample.xaml.cs">
    <src:SourceFile.Source>
      <sys:String xml:space="preserve">// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.

using System;
using System.ComponentModel;
using System.Diagnostics.CodeAnalysis;

namespace System.Windows.Controls.Samples
{
    /// &lt;summary&gt;
    /// Demonstrate different TreeView templates.
    /// &lt;/summary&gt;
    [Sample("(5)Templating", DifficultyLevel.Basic, "TreeView")]
    [SuppressMessage("Microsoft.Naming", "CA1704:IdentifiersShouldBeSpelledCorrectly", MessageId = "Templating", Justification = "Correct spelling")]
    public partial class TreeViewTemplatingSample : UserControl
    {
        /// &lt;summary&gt;
        /// Initializes a new instance of the TreeViewTemplatingSample class.
        /// &lt;/summary&gt;
        public TreeViewTemplatingSample()
        {
            InitializeComponent();

            TreeDefault.ItemsSource = Taxonomy.Life;
            TreeCheckBox.ItemsSource = Taxonomy.Life;
            TreeFullRow.ItemsSource = Taxonomy.Life;
            TreeLines.ItemsSource = Taxonomy.Life;
        }

        /// &lt;summary&gt;
        /// Expand all of the TreeViewItems.
        /// &lt;/summary&gt;
        /// &lt;param name="sender"&gt;The Expand All Button.&lt;/param&gt;
        /// &lt;param name="e"&gt;Event arguments.&lt;/param&gt;
        [SuppressMessage("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Justification = "The event handler is declared in XAML.")]
        private void OnExpandAll(object sender, RoutedEventArgs e)
        {
            Button button = sender as Button;
            if (button != null)
            {
                TreeView view = button.Tag as TreeView;
                if (view != null)
                {
                    view.ExpandAll();
                }
            }
        }
    }
}</sys:String>
    </src:SourceFile.Source>
  </src:SourceFile>
  <src:SourceFile Path="TreeViewDefault.xaml">
    <src:SourceFile.Source>
      <sys:String xml:space="preserve">&lt;!--
// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.
--&gt;

&lt;ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
  xmlns:toolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
  xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
  xmlns:system="clr-namespace:System;assembly=mscorlib"&gt;

    &lt;ControlTemplate x:Key="CommonValidationToolTipTemplate" TargetType="ToolTip"&gt;
        &lt;Grid
          x:Name="Root"
          Margin="5,0"
          RenderTransformOrigin="0,0"
          Opacity="0"&gt;
            &lt;Grid.RenderTransform&gt;
                &lt;TranslateTransform x:Name="Translation" X="-25" /&gt;
            &lt;/Grid.RenderTransform&gt;
            &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                &lt;vsm:VisualStateGroup Name="OpenStates"&gt;
                    &lt;vsm:VisualStateGroup.Transitions&gt;
                        &lt;vsm:VisualTransition GeneratedDuration="0" /&gt;
                        &lt;vsm:VisualTransition To="Open" GeneratedDuration="0:0:0.2"&gt;
                            &lt;Storyboard&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Translation"
                                  Storyboard.TargetProperty="X"
                                  To="0"
                                  Duration="0:0:0.2"&gt;
                                    &lt;DoubleAnimation.EasingFunction&gt;
                                        &lt;BackEase Amplitude=".3" EasingMode="EaseOut" /&gt;
                                    &lt;/DoubleAnimation.EasingFunction&gt;
                                &lt;/DoubleAnimation&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Root"
                                  Storyboard.TargetProperty="Opacity"
                                  To="1"
                                  Duration="0:0:0.2" /&gt;
                            &lt;/Storyboard&gt;
                        &lt;/vsm:VisualTransition&gt;
                    &lt;/vsm:VisualStateGroup.Transitions&gt;
                    &lt;vsm:VisualState x:Name="Closed"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="0"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                    &lt;vsm:VisualState x:Name="Open"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Translation"
                              Storyboard.TargetProperty="X"
                              To="0"
                              Duration="0" /&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="1"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                &lt;/vsm:VisualStateGroup&gt;
            &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

            &lt;Border Margin="4,4,-4,-4" Background="#052A2E31" CornerRadius="5" /&gt;
            &lt;Border Margin="3,3,-3,-3" Background="#152A2E31" CornerRadius="4" /&gt;
            &lt;Border Margin="2,2,-2,-2" Background="#252A2E31" CornerRadius="3" /&gt;
            &lt;Border Margin="1,1,-1,-1" Background="#352A2E31" CornerRadius="2" /&gt;

            &lt;Border
              Background="#FFDC000C"
              CornerRadius="2"&gt;
                &lt;TextBlock 
                  UseLayoutRounding="false" 
                  Foreground="#FFFFFFFF"
                  Margin="8,4,8,4"
                  MaxWidth="250"
                  TextWrapping="Wrap"
                  Text="{Binding (Validation.Errors)[0].ErrorContent}" /&gt;
            &lt;/Border&gt;
        &lt;/Grid&gt;
    &lt;/ControlTemplate&gt;
   
    &lt;Style x:Key="DefaultTreeView" TargetType="controls:TreeView"&gt;
        &lt;Setter Property="Background" Value="#FFFFFFFF" /&gt;
        &lt;Setter Property="Foreground" Value="#FF000000" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="BorderThickness" Value="1" /&gt;
        &lt;Setter Property="Padding" Value="1" /&gt;
        &lt;Setter Property="BorderBrush" Value="#FF000000" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeView"&gt;
                    &lt;Grid&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="MouseOver" /&gt;
                                &lt;vsm:VisualState x:Name="Pressed" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="FocusStates"&gt;
                                &lt;vsm:VisualState x:Name="Unfocused" /&gt;
                                &lt;vsm:VisualState x:Name="Focused" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ValidationStates" &gt;
                                &lt;vsm:VisualState x:Name="Valid" /&gt;
                                &lt;vsm:VisualState x:Name="InvalidUnfocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="InvalidFocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ValidationToolTip"
                                          Storyboard.TargetProperty="IsOpen"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;system:Boolean&gt;True&lt;/system:Boolean&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

                        &lt;Border
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          CornerRadius="2"&gt;
                            &lt;Border                              
                              Padding="{TemplateBinding Padding}"
                              Background="{TemplateBinding Background}"
                              Margin="1"&gt;
                                &lt;ScrollViewer
                                  x:Name="ScrollViewer"
                                  HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto"
                                  Background="{x:Null}"
                                  BorderBrush="Transparent"
                                  BorderThickness="0"
                                  IsTabStop="False"
                                  TabNavigation="Once"
                                  toolkit:ScrollViewerExtensions.IsMouseWheelScrollingEnabled="True"&gt;
                                    &lt;Grid Background="{TemplateBinding Background}"&gt;
                                        &lt;ItemsPresenter Margin="5" /&gt;
                                    &lt;/Grid&gt;
                                &lt;/ScrollViewer&gt;
                            &lt;/Border&gt;
                        &lt;/Border&gt;

                        &lt;Border
                          x:Name="Validation"
                          Grid.Column="1"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;
                    &lt;/Grid&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

    &lt;Style x:Key="DefaultTreeViewItem" TargetType="controls:TreeViewItem"&gt;
        &lt;Setter Property="Padding" Value="3" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Background" Value="Transparent" /&gt;
        &lt;Setter Property="BorderThickness" Value="1" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Margin" Value="0 1 0 0" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeViewItem"&gt;
                    &lt;Grid Background="{x:Null}"&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="MouseOver" /&gt;
                                &lt;vsm:VisualState x:Name="Pressed" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Header"
                                          Storyboard.TargetProperty="Foreground"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;SolidColorBrush Color="#FF999999" /&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="SelectionStates"&gt;
                                &lt;vsm:VisualState x:Name="Unselected" /&gt;
                                &lt;vsm:VisualState x:Name="Selected"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".75" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="SelectedInactive"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".2" /&gt;
                                        &lt;ColorAnimation
                                          Storyboard.TargetName="SelectionFill"
                                          Storyboard.TargetProperty="Color"
                                          Duration="0"
                                          To="#FF999999" /&gt;
                                        &lt;ColorAnimation
                                          Storyboard.TargetName="SelectionStroke"
                                          Storyboard.TargetProperty="Color"
                                          Duration="0"
                                          To="#FF333333" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="HasItemsStates"&gt;
                                &lt;vsm:VisualState x:Name="HasItems" /&gt;
                                &lt;vsm:VisualState x:Name="NoItems"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ExpanderButton"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ExpansionStates"&gt;
                                &lt;vsm:VisualState x:Name="Collapsed" /&gt;
                                &lt;vsm:VisualState x:Name="Expanded"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ItemsHost"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ValidationStates" &gt;
                                &lt;vsm:VisualState x:Name="Valid" /&gt;
                                &lt;vsm:VisualState x:Name="InvalidUnfocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="InvalidFocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ValidationToolTip"
                                          Storyboard.TargetProperty="IsOpen"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;system:Boolean&gt;True&lt;/system:Boolean&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                            &lt;RowDefinition Height="*" /&gt;
                        &lt;/Grid.RowDefinitions&gt;
                        &lt;Grid.ColumnDefinitions&gt;
                            &lt;ColumnDefinition Width="15" /&gt;
                            &lt;ColumnDefinition Width="Auto" /&gt;
                            &lt;ColumnDefinition Width="*" /&gt;
                        &lt;/Grid.ColumnDefinitions&gt;

                        &lt;ToggleButton
                          x:Name="ExpanderButton"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          IsTabStop="False"
                          TabNavigation="Once"&gt;
                            &lt;ToggleButton.Template&gt;
                                &lt;ControlTemplate TargetType="ToggleButton"&gt;
                                    &lt;Grid x:Name="Root" Background="Transparent"&gt;
                                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                &lt;vsm:VisualState x:Name="MouseOver"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="UncheckedVisual"
                                                          Storyboard.TargetProperty="(Path.Stroke).Color"
                                                          To="#FF1BBBFA"
                                                          Duration="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Root"
                                                          Storyboard.TargetProperty="Opacity"
                                                          To=".7"
                                                          Duration="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CheckStates"&gt;
                                                &lt;vsm:VisualState x:Name="Unchecked" /&gt;
                                                &lt;vsm:VisualState x:Name="Checked"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="UncheckedVisual"
                                                          Storyboard.TargetProperty="Opacity"
                                                          To="0"
                                                          Duration="0" /&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="CheckedVisual"
                                                          Storyboard.TargetProperty="Opacity"
                                                          To="1"
                                                          Duration="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                        &lt;Grid HorizontalAlignment="Right" Margin="2 2 5 2"&gt;
                                            &lt;Path
                                              x:Name="UncheckedVisual"
                                              Width="6"
                                              Height="9"
                                              Fill="#FFFFFFFF"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Right"
                                              Data="M 0,0 L 0,9 L 5,4.5 Z"
                                              StrokeThickness="1"
                                              StrokeLineJoin="Miter"&gt;
                                                &lt;Path.Stroke&gt;
                                                    &lt;SolidColorBrush Color="#FF989898" /&gt;
                                                &lt;/Path.Stroke&gt;
                                            &lt;/Path&gt;
                                            &lt;Path
                                              x:Name="CheckedVisual"
                                              Opacity="0"
                                              Width="6"
                                              Height="6"
                                              Fill="#FF262626"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Center"
                                              Data="M 6,0 L 6,6 L 0,6 Z"
                                              StrokeLineJoin="Miter" /&gt;
                                        &lt;/Grid&gt;
                                    &lt;/Grid&gt;
                                &lt;/ControlTemplate&gt;
                            &lt;/ToggleButton.Template&gt;
                        &lt;/ToggleButton&gt;
                        &lt;Rectangle
                          x:Name="Selection"
                          Grid.Column="1"
                          Opacity="0"
                          StrokeThickness="1"
                          IsHitTestVisible="False"
                          RadiusX="2"
                          RadiusY="2"&gt;
                            &lt;Rectangle.Fill&gt;
                                &lt;SolidColorBrush x:Name="SelectionFill" Color="#FFBADDE9" /&gt;
                            &lt;/Rectangle.Fill&gt;
                            &lt;Rectangle.Stroke&gt;
                                &lt;SolidColorBrush x:Name="SelectionStroke" Color="#FF6DBDD1" /&gt;
                            &lt;/Rectangle.Stroke&gt;
                        &lt;/Rectangle&gt;
                        &lt;Button
                          x:Name="Header"
                          Grid.Column="1"
                          ClickMode="Hover"
                          Background="{TemplateBinding Background}"
                          Foreground="{TemplateBinding Foreground}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Cursor="{TemplateBinding Cursor}"
                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                          IsTabStop="False"
                          TabNavigation="Once"&gt;
                            &lt;Button.Template&gt;
                                &lt;ControlTemplate TargetType="Button"&gt;
                                    &lt;Grid Background="{TemplateBinding Background}"&gt;
                                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                &lt;vsm:VisualState x:Name="Pressed"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Hover"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To=".5" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Content"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To=".55" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                        &lt;Rectangle
                                          x:Name="Hover"
                                          Opacity="0"
                                          Fill="#FFBADDE9"
                                          Stroke="#FF6DBDD1"
                                          StrokeThickness="1"
                                          IsHitTestVisible="False"
                                          RadiusX="2"
                                          RadiusY="2" /&gt;
                                        &lt;ContentPresenter
                                          x:Name="Content"
                                          Cursor="{TemplateBinding Cursor}"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          HorizontalAlignment="Left"
                                          Margin="{TemplateBinding Padding}" /&gt;
                                    &lt;/Grid&gt;
                                &lt;/ControlTemplate&gt;
                            &lt;/Button.Template&gt;
                            &lt;Button.Content&gt;
                                &lt;ContentPresenter
                                  Content="{TemplateBinding Header}"
                                  ContentTemplate="{TemplateBinding HeaderTemplate}" /&gt;
                            &lt;/Button.Content&gt;
                        &lt;/Button&gt;

                        &lt;Border
                          x:Name="Validation"
                          Grid.Column="1"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding ElementName=Header}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;

                        &lt;ItemsPresenter
                          x:Name="ItemsHost"
                          Grid.Row="1"
                          Grid.Column="1"
                          Grid.ColumnSpan="2"
                          Visibility="Collapsed" /&gt;
                    &lt;/Grid&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

&lt;/ResourceDictionary&gt;</sys:String>
    </src:SourceFile.Source>
  </src:SourceFile>
  <src:SourceFile Path="TreeViewFullRowSelect.xaml">
    <src:SourceFile.Source>
      <sys:String xml:space="preserve">&lt;!--
// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.
--&gt;

&lt;ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
  xmlns:toolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
  xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
  xmlns:system="clr-namespace:System;assembly=mscorlib"&gt;

    &lt;ControlTemplate x:Key="CommonValidationToolTipTemplate" TargetType="ToolTip"&gt;
        &lt;Grid
          x:Name="Root"
          Margin="5,0"
          RenderTransformOrigin="0,0"
          Opacity="0"&gt;
            &lt;Grid.RenderTransform&gt;
                &lt;TranslateTransform x:Name="Translation" X="-25" /&gt;
            &lt;/Grid.RenderTransform&gt;
            &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                &lt;vsm:VisualStateGroup Name="OpenStates"&gt;
                    &lt;vsm:VisualStateGroup.Transitions&gt;
                        &lt;vsm:VisualTransition GeneratedDuration="0" /&gt;
                        &lt;vsm:VisualTransition To="Open" GeneratedDuration="0:0:0.2"&gt;
                            &lt;Storyboard&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Translation"
                                  Storyboard.TargetProperty="X"
                                  To="0"
                                  Duration="0:0:0.2"&gt;
                                    &lt;DoubleAnimation.EasingFunction&gt;
                                        &lt;BackEase Amplitude=".3" EasingMode="EaseOut" /&gt;
                                    &lt;/DoubleAnimation.EasingFunction&gt;
                                &lt;/DoubleAnimation&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Root"
                                  Storyboard.TargetProperty="Opacity"
                                  To="1"
                                  Duration="0:0:0.2" /&gt;
                            &lt;/Storyboard&gt;
                        &lt;/vsm:VisualTransition&gt;
                    &lt;/vsm:VisualStateGroup.Transitions&gt;
                    &lt;vsm:VisualState x:Name="Closed"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="0"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                    &lt;vsm:VisualState x:Name="Open"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Translation"
                              Storyboard.TargetProperty="X"
                              To="0"
                              Duration="0" /&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="1"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                &lt;/vsm:VisualStateGroup&gt;
            &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

            &lt;Border Margin="4,4,-4,-4" Background="#052A2E31" CornerRadius="5" /&gt;
            &lt;Border Margin="3,3,-3,-3" Background="#152A2E31" CornerRadius="4" /&gt;
            &lt;Border Margin="2,2,-2,-2" Background="#252A2E31" CornerRadius="3" /&gt;
            &lt;Border Margin="1,1,-1,-1" Background="#352A2E31" CornerRadius="2" /&gt;

            &lt;Border
              Background="#FFDC000C"
              CornerRadius="2"&gt;
                &lt;TextBlock 
                  UseLayoutRounding="false" 
                  Foreground="#FFFFFFFF"
                  Margin="8,4,8,4"
                  MaxWidth="250"
                  TextWrapping="Wrap"
                  Text="{Binding (Validation.Errors)[0].ErrorContent}" /&gt;
            &lt;/Border&gt;
        &lt;/Grid&gt;
    &lt;/ControlTemplate&gt;

    &lt;Style x:Key="FullRowSelectTreeView" TargetType="controls:TreeView"&gt;
        &lt;Setter Property="Background" Value="#FFFFFFFF" /&gt;
        &lt;Setter Property="Foreground" Value="#FF000000" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="BorderThickness" Value="1" /&gt;
        &lt;Setter Property="Padding" Value="0" /&gt;
        &lt;Setter Property="BorderBrush" Value="#FF000000" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeView"&gt;
                    &lt;Grid&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="MouseOver" /&gt;
                                &lt;vsm:VisualState x:Name="Pressed" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="FocusStates"&gt;
                                &lt;vsm:VisualState x:Name="Unfocused" /&gt;
                                &lt;vsm:VisualState x:Name="Focused" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ValidationStates" &gt;
                                &lt;vsm:VisualState x:Name="Valid" /&gt;
                                &lt;vsm:VisualState x:Name="InvalidUnfocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="InvalidFocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ValidationToolTip"
                                          Storyboard.TargetProperty="IsOpen"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;system:Boolean&gt;True&lt;/system:Boolean&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

                        &lt;Border
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          CornerRadius="2"&gt;
                            &lt;Border                              
                              Padding="{TemplateBinding Padding}"
                              Background="{TemplateBinding Background}"&gt;
                                &lt;ScrollViewer
                                  HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto"
                                  Background="{x:Null}"
                                  BorderBrush="Transparent"
                                  BorderThickness="0"
                                  IsTabStop="False"
                                  TabNavigation="Once"
                                  Margin="1"
                                  Padding="0"
                                  toolkit:ScrollViewerExtensions.IsMouseWheelScrollingEnabled="True"&gt;
                                    &lt;Grid Background="{TemplateBinding Background}"&gt;
                                        &lt;ItemsPresenter /&gt;
                                    &lt;/Grid&gt;
                                &lt;/ScrollViewer&gt;
                            &lt;/Border&gt;
                        &lt;/Border&gt;

                        &lt;Border
                          x:Name="Validation"
                          Grid.Column="1"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;
                    &lt;/Grid&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

    &lt;Style x:Key="FullRowSelectTreeViewItem" TargetType="controls:TreeViewItem"&gt;
        &lt;Setter Property="Padding" Value="0" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Background" Value="Transparent" /&gt;
        &lt;Setter Property="BorderThickness" Value="0" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeViewItem"&gt;
                    &lt;StackPanel Background="{x:Null}"&gt;
                        &lt;StackPanel.Resources&gt;
                            &lt;toolkit:TreeViewItemIndentationConverter x:Key="IndentConverter" /&gt;
                        &lt;/StackPanel.Resources&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Header"
                                          Storyboard.TargetProperty="Foreground"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;SolidColorBrush Color="#FF999999" /&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Content"
                                          Storyboard.TargetProperty="Foreground"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;SolidColorBrush Color="#FF999999" /&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="SelectionStates"&gt;
                                &lt;vsm:VisualState x:Name="Unselected" /&gt;
                                &lt;vsm:VisualState x:Name="Selected"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".75" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="SelectedInactive"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".2" /&gt;
                                        &lt;ColorAnimation
                                          Storyboard.TargetName="SelectionFill"
                                          Storyboard.TargetProperty="Color"
                                          Duration="0"
                                          To="#FF999999" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="HasItemsStates"&gt;
                                &lt;vsm:VisualState x:Name="HasItems" /&gt;
                                &lt;vsm:VisualState x:Name="NoItems"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ExpanderButton"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ExpansionStates"&gt;
                                &lt;vsm:VisualState x:Name="Collapsed" /&gt;
                                &lt;vsm:VisualState x:Name="Expanded"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ItemsHost"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

                        &lt;Border Background="{x:Null}" CornerRadius="2"&gt;
                            &lt;Grid&gt;
                                &lt;Rectangle
                                  x:Name="Selection"
                                  Opacity="0"
                                  IsHitTestVisible="False"&gt;
                                    &lt;Rectangle.Fill&gt;
                                        &lt;SolidColorBrush x:Name="SelectionFill" Color="#FFBADDE9" /&gt;
                                    &lt;/Rectangle.Fill&gt;
                                &lt;/Rectangle&gt;

                                &lt;Button
                                  x:Name="Header"
                                  ClickMode="Hover"
                                  Background="{TemplateBinding Background}"
                                  Cursor="{TemplateBinding Cursor}"
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch"
                                  IsTabStop="False"
                                  TabNavigation="Once"&gt;
                                    &lt;Button.Template&gt;
                                        &lt;ControlTemplate TargetType="Button"&gt;
                                            &lt;Grid Background="{TemplateBinding Background}"&gt;
                                                &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                                    &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                                        &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                        &lt;vsm:VisualState x:Name="Pressed"&gt;
                                                            &lt;Storyboard&gt;
                                                                &lt;DoubleAnimation
                                                                  Storyboard.TargetName="Hover"
                                                                  Storyboard.TargetProperty="Opacity"
                                                                  Duration="0"
                                                                  To=".5" /&gt;
                                                            &lt;/Storyboard&gt;
                                                        &lt;/vsm:VisualState&gt;
                                                        &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                            &lt;Storyboard&gt;
                                                                &lt;DoubleAnimation
                                                                  Storyboard.TargetName="Content"
                                                                  Storyboard.TargetProperty="Opacity"
                                                                  Duration="0"
                                                                  To=".55" /&gt;
                                                            &lt;/Storyboard&gt;
                                                        &lt;/vsm:VisualState&gt;
                                                    &lt;/vsm:VisualStateGroup&gt;
                                                &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                                &lt;Rectangle
                                                  x:Name="Hover"
                                                  Opacity="0"
                                                  Fill="#FFBADDE9"
                                                  IsHitTestVisible="False" /&gt;
                                                &lt;ContentPresenter
                                                  x:Name="Content"
                                                  Cursor="{TemplateBinding Cursor}"
                                                  Content="{TemplateBinding Content}"
                                                  ContentTemplate="{TemplateBinding ContentTemplate}"
                                                  HorizontalAlignment="Left"
                                                  Margin="{TemplateBinding Padding}" /&gt;
                                            &lt;/Grid&gt;
                                        &lt;/ControlTemplate&gt;
                                    &lt;/Button.Template&gt;
                                    &lt;Button.Content&gt;
                                        &lt;Border BorderThickness="0" Margin="10 0 0 0"&gt;
                                            &lt;Grid Margin="{Binding RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource IndentConverter}}"&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="15" /&gt;
                                                    &lt;ColumnDefinition Width="*" /&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;ToggleButton
                                                  x:Name="ExpanderButton"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Stretch"
                                                  IsTabStop="False"
                                                  TabNavigation="Once"&gt;
                                                    &lt;ToggleButton.Template&gt;
                                                        &lt;ControlTemplate TargetType="ToggleButton"&gt;
                                                            &lt;Grid x:Name="Root" Background="Transparent"&gt;
                                                                &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                                                    &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                                                        &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                                        &lt;vsm:VisualState x:Name="MouseOver"&gt;
                                                                            &lt;Storyboard&gt;
                                                                                &lt;ColorAnimation
                                                                                  Storyboard.TargetName="UncheckedVisual"
                                                                                  Storyboard.TargetProperty="(Path.Stroke).Color"
                                                                                  To="#FF1BBBFA"
                                                                                  Duration="0" /&gt;
                                                                            &lt;/Storyboard&gt;
                                                                        &lt;/vsm:VisualState&gt;
                                                                        &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                                            &lt;Storyboard&gt;
                                                                                &lt;DoubleAnimation
                                                                                  Storyboard.TargetName="Root"
                                                                                  Storyboard.TargetProperty="Opacity"
                                                                                  To=".7"
                                                                                  Duration="0" /&gt;
                                                                            &lt;/Storyboard&gt;
                                                                        &lt;/vsm:VisualState&gt;
                                                                    &lt;/vsm:VisualStateGroup&gt;
                                                                    &lt;vsm:VisualStateGroup x:Name="CheckStates"&gt;
                                                                        &lt;vsm:VisualState x:Name="Unchecked" /&gt;
                                                                        &lt;vsm:VisualState x:Name="Checked"&gt;
                                                                            &lt;Storyboard&gt;
                                                                                &lt;DoubleAnimation
                                                                                  Storyboard.TargetName="UncheckedVisual"
                                                                                  Storyboard.TargetProperty="Opacity"
                                                                                  To="0"
                                                                                  Duration="0" /&gt;
                                                                                &lt;DoubleAnimation
                                                                                  Storyboard.TargetName="CheckedVisual"
                                                                                  Storyboard.TargetProperty="Opacity"
                                                                                  To="1"
                                                                                  Duration="0" /&gt;
                                                                            &lt;/Storyboard&gt;
                                                                        &lt;/vsm:VisualState&gt;
                                                                    &lt;/vsm:VisualStateGroup&gt;
                                                                &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                                                &lt;Grid HorizontalAlignment="Right" Margin="2 2 5 2"&gt;
                                                                    &lt;Path
                                                                      x:Name="UncheckedVisual"
                                                                      Width="6"
                                                                      Height="9"
                                                                      Fill="#FFFFFFFF"
                                                                      VerticalAlignment="Center"
                                                                      HorizontalAlignment="Right"
                                                                      Data="M 0,0 L 0,9 L 5,4.5 Z"
                                                                      StrokeThickness="1"
                                                                      StrokeLineJoin="Miter"&gt;
                                                                        &lt;Path.Stroke&gt;
                                                                            &lt;SolidColorBrush Color="#FF989898" /&gt;
                                                                        &lt;/Path.Stroke&gt;
                                                                    &lt;/Path&gt;
                                                                    &lt;Path
                                                                      x:Name="CheckedVisual"
                                                                      Opacity="0"
                                                                      Width="6"
                                                                      Height="6"
                                                                      Fill="#FF262626"
                                                                      VerticalAlignment="Center"
                                                                      HorizontalAlignment="Center"
                                                                      Data="M 6,0 L 6,6 L 0,6 Z"
                                                                      StrokeLineJoin="Miter" /&gt;
                                                                &lt;/Grid&gt;
                                                            &lt;/Grid&gt;
                                                        &lt;/ControlTemplate&gt;
                                                    &lt;/ToggleButton.Template&gt;
                                                &lt;/ToggleButton&gt;
                                                &lt;ContentControl
                                                  x:Name="Content"
                                                  Grid.Column="1"
                                                  Cursor="{TemplateBinding Cursor}"
                                                  Foreground="{TemplateBinding Foreground}"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                  Padding="{TemplateBinding Padding}"&gt;
                                                    &lt;ContentControl.Content&gt;
                                                        &lt;ContentPresenter
                                                          Content="{TemplateBinding Header}"
                                                          ContentTemplate="{TemplateBinding HeaderTemplate}" /&gt;
                                                    &lt;/ContentControl.Content&gt;
                                                &lt;/ContentControl&gt;
                                            &lt;/Grid&gt;
                                        &lt;/Border&gt;
                                    &lt;/Button.Content&gt;
                                &lt;/Button&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;

                        &lt;Border
                          x:Name="Validation"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding ElementName=Content}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;

                        &lt;ItemsPresenter
                          x:Name="ItemsHost"
                          Visibility="Collapsed" /&gt;
                    &lt;/StackPanel&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

&lt;/ResourceDictionary&gt;</sys:String>
    </src:SourceFile.Source>
  </src:SourceFile>
  <src:SourceFile Path="TreeViewConnectingLines.xaml">
    <src:SourceFile.Source>
      <sys:String xml:space="preserve">&lt;!--
// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.
--&gt;

&lt;ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
  xmlns:toolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
  xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
  xmlns:system="clr-namespace:System;assembly=mscorlib"&gt;

    &lt;ControlTemplate x:Key="CommonValidationToolTipTemplate" TargetType="ToolTip"&gt;
        &lt;Grid
          x:Name="Root"
          Margin="5,0"
          RenderTransformOrigin="0,0"
          Opacity="0"&gt;
            &lt;Grid.RenderTransform&gt;
                &lt;TranslateTransform x:Name="Translation" X="-25" /&gt;
            &lt;/Grid.RenderTransform&gt;
            &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                &lt;vsm:VisualStateGroup Name="OpenStates"&gt;
                    &lt;vsm:VisualStateGroup.Transitions&gt;
                        &lt;vsm:VisualTransition GeneratedDuration="0" /&gt;
                        &lt;vsm:VisualTransition To="Open" GeneratedDuration="0:0:0.2"&gt;
                            &lt;Storyboard&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Translation"
                                  Storyboard.TargetProperty="X"
                                  To="0"
                                  Duration="0:0:0.2"&gt;
                                    &lt;DoubleAnimation.EasingFunction&gt;
                                        &lt;BackEase Amplitude=".3" EasingMode="EaseOut" /&gt;
                                    &lt;/DoubleAnimation.EasingFunction&gt;
                                &lt;/DoubleAnimation&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Root"
                                  Storyboard.TargetProperty="Opacity"
                                  To="1"
                                  Duration="0:0:0.2" /&gt;
                            &lt;/Storyboard&gt;
                        &lt;/vsm:VisualTransition&gt;
                    &lt;/vsm:VisualStateGroup.Transitions&gt;
                    &lt;vsm:VisualState x:Name="Closed"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="0"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                    &lt;vsm:VisualState x:Name="Open"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Translation"
                              Storyboard.TargetProperty="X"
                              To="0"
                              Duration="0" /&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="1"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                &lt;/vsm:VisualStateGroup&gt;
            &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

            &lt;Border Margin="4,4,-4,-4" Background="#052A2E31" CornerRadius="5" /&gt;
            &lt;Border Margin="3,3,-3,-3" Background="#152A2E31" CornerRadius="4" /&gt;
            &lt;Border Margin="2,2,-2,-2" Background="#252A2E31" CornerRadius="3" /&gt;
            &lt;Border Margin="1,1,-1,-1" Background="#352A2E31" CornerRadius="2" /&gt;

            &lt;Border
              Background="#FFDC000C"
              CornerRadius="2"&gt;
                &lt;TextBlock 
                  UseLayoutRounding="false" 
                  Foreground="#FFFFFFFF"
                  Margin="8,4,8,4"
                  MaxWidth="250"
                  TextWrapping="Wrap"
                  Text="{Binding (Validation.Errors)[0].ErrorContent}" /&gt;
            &lt;/Border&gt;
        &lt;/Grid&gt;
    &lt;/ControlTemplate&gt;

    &lt;Style x:Key="ConnectingLinesTreeView" TargetType="controls:TreeView"&gt;
        &lt;Setter Property="Background" Value="#FFFFFFFF" /&gt;
        &lt;Setter Property="Foreground" Value="#FF000000" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="BorderThickness" Value="1" /&gt;
        &lt;Setter Property="Padding" Value="1" /&gt;
        &lt;Setter Property="BorderBrush" Value="#FF000000" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeView"&gt;
                    &lt;Grid&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="MouseOver" /&gt;
                                &lt;vsm:VisualState x:Name="Pressed" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="FocusStates"&gt;
                                &lt;vsm:VisualState x:Name="Unfocused" /&gt;
                                &lt;vsm:VisualState x:Name="Focused" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ValidationStates" &gt;
                                &lt;vsm:VisualState x:Name="Valid" /&gt;
                                &lt;vsm:VisualState x:Name="InvalidUnfocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="InvalidFocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ValidationToolTip"
                                          Storyboard.TargetProperty="IsOpen"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;system:Boolean&gt;True&lt;/system:Boolean&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

                        &lt;Border
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          CornerRadius="2"&gt;
                            &lt;Border                              
                              Padding="{TemplateBinding Padding}"
                              Background="{TemplateBinding Background}"
                              Margin="1"&gt;
                                &lt;ScrollViewer
                                  x:Name="ScrollViewer"
                                  HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto"
                                  Background="{x:Null}"
                                  BorderBrush="Transparent"
                                  BorderThickness="0"
                                  IsTabStop="False"
                                  TabNavigation="Once"
                                  toolkit:ScrollViewerExtensions.IsMouseWheelScrollingEnabled="True"&gt;
                                    &lt;Grid Background="{TemplateBinding Background}"&gt;
                                        &lt;ItemsPresenter Margin="5" /&gt;
                                    &lt;/Grid&gt;
                                &lt;/ScrollViewer&gt;
                            &lt;/Border&gt;
                        &lt;/Border&gt;

                        &lt;Border
                          x:Name="Validation"
                          Grid.Column="1"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;
                    &lt;/Grid&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

    &lt;Style x:Key="ConnectingLinesTreeViewItem" TargetType="controls:TreeViewItem"&gt;
        &lt;Setter Property="Padding" Value="3" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Background" Value="Transparent" /&gt;
        &lt;Setter Property="BorderThickness" Value="1" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Margin" Value="0 1 0 0" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeViewItem"&gt;
                    &lt;Grid Background="{x:Null}"&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="MouseOver" /&gt;
                                &lt;vsm:VisualState x:Name="Pressed" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Header"
                                          Storyboard.TargetProperty="Foreground"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;SolidColorBrush Color="#FF999999" /&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="SelectionStates"&gt;
                                &lt;vsm:VisualState x:Name="Unselected" /&gt;
                                &lt;vsm:VisualState x:Name="Selected"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".75" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="SelectedInactive"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".2" /&gt;
                                        &lt;ColorAnimation
                                          Storyboard.TargetName="SelectionFill"
                                          Storyboard.TargetProperty="Color"
                                          Duration="0"
                                          To="#FF999999" /&gt;
                                        &lt;ColorAnimation
                                          Storyboard.TargetName="SelectionStroke"
                                          Storyboard.TargetProperty="Color"
                                          Duration="0"
                                          To="#FF333333" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="HasItemsStates"&gt;
                                &lt;vsm:VisualState x:Name="HasItems" /&gt;
                                &lt;vsm:VisualState x:Name="NoItems"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ExpanderButton"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ExpansionStates"&gt;
                                &lt;vsm:VisualState x:Name="Collapsed" /&gt;
                                &lt;vsm:VisualState x:Name="Expanded"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ItemsHost"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ValidationStates" &gt;
                                &lt;vsm:VisualState x:Name="Valid" /&gt;
                                &lt;vsm:VisualState x:Name="InvalidUnfocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="InvalidFocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ValidationToolTip"
                                          Storyboard.TargetProperty="IsOpen"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;system:Boolean&gt;True&lt;/system:Boolean&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                            &lt;RowDefinition Height="*" /&gt;
                        &lt;/Grid.RowDefinitions&gt;
                        &lt;Grid.ColumnDefinitions&gt;
                            &lt;ColumnDefinition Width="15" /&gt;
                            &lt;ColumnDefinition Width="Auto" /&gt;
                            &lt;ColumnDefinition Width="*" /&gt;
                        &lt;/Grid.ColumnDefinitions&gt;
                        
                        &lt;Line
                          toolkit:TreeViewConnectingLines.IsHorizontalConnectingLineOf="{Binding RelativeSource={RelativeSource TemplatedParent}, Mode=OneTime}"
                          Grid.ColumnSpan="2"
                          Stroke="Gray"
                          StrokeDashArray="1 1"
                          X1="9"
                          Y1="10"
                          X2="18"
                          Y2="10" /&gt;
                        &lt;Line
                          toolkit:TreeViewConnectingLines.IsVerticalConnectingLineOf="{Binding RelativeSource={RelativeSource TemplatedParent}, Mode=OneTime}"
                          Grid.Row="1"
                          Grid.Column="1"
                          Stroke="Gray"
                          StrokeDashArray="1 1"
                          X1="8"
                          Y1="-5"
                          X2="8"
                          Y2="0" /&gt;

                        &lt;ToggleButton
                          x:Name="ExpanderButton"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          IsThreeState="False"
                          IsTabStop="False"
                          TabNavigation="Once"
                          Background="#FF448DCA"
                          BorderThickness="1"
                          toolkit:TreeViewConnectingLines.IsExpanderButtonOf="{Binding RelativeSource={RelativeSource TemplatedParent}, Mode=OneTime}"&gt;
                            &lt;ToggleButton.BorderBrush&gt;
                                &lt;LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0"&gt;
                                    &lt;GradientStop Color="#FFA3AEB9" Offset="0" /&gt;
                                    &lt;GradientStop Color="#FF8399A9" Offset="0.375" /&gt;
                                    &lt;GradientStop Color="#FF718597" Offset="0.375" /&gt;
                                    &lt;GradientStop Color="#FF617584" Offset="1" /&gt;
                                &lt;/LinearGradientBrush&gt;
                            &lt;/ToggleButton.BorderBrush&gt;
                            &lt;ToggleButton.Template&gt;
                                &lt;ControlTemplate TargetType="ToggleButton"&gt;
                                    &lt;Grid&gt;
                                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CommonStates" &gt;
                                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                &lt;vsm:VisualState x:Name="MouseOver"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="BackgroundOverlay"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To="1" /&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="BoxMiddleBackground"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To="1" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[3].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#7FFFFFFF" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[2].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#CCFFFFFF" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[1].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#F2FFFFFF" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Pressed"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="BackgroundOverlay"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To="1" /&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="BoxMiddleBackground"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To="1" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[3].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#6BFFFFFF" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[2].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#C6FFFFFF" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[1].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#EAFFFFFF" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Fill).(GradientBrush.GradientStops)[0].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#F4FFFFFF" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[3].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#FF6DBDD1" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[0].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#FF6DBDD1" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[1].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#FF6DBDD1" /&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="BoxMiddle"
                                                          Storyboard.TargetProperty="(Shape.Stroke).(GradientBrush.GradientStops)[2].(GradientStop.Color)"
                                                          Duration="0"
                                                          To="#FF6DBDD1" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="DisabledVisualElement"
                                                          Storyboard.TargetProperty="(UIElement.Opacity)"
                                                          Duration="0"
                                                          To="0.55" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CheckStates" &gt;
                                                &lt;vsm:VisualState x:Name="Checked"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="UncheckedVisual"
                                                          Storyboard.TargetProperty="(UIElement.Opacity)"
                                                          Duration="0"
                                                          To="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Unchecked"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="UncheckedVisual"
                                                          Storyboard.TargetProperty="(UIElement.Opacity)"
                                                          Duration="0"
                                                          To="1" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Indeterminate"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="UncheckedVisual"
                                                          Storyboard.TargetProperty="(UIElement.Opacity)"
                                                          Duration="0"
                                                          To="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                        &lt;Grid.ColumnDefinitions&gt;
                                            &lt;ColumnDefinition Width="12" /&gt;
                                        &lt;/Grid.ColumnDefinitions&gt;
                                        &lt;Grid.RowDefinitions&gt;
                                            &lt;RowDefinition Height="12" /&gt;
                                        &lt;/Grid.RowDefinitions&gt;
                                        &lt;Grid
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Top"&gt;
                                            &lt;Rectangle
                                              x:Name="Background"
                                              Width="10"
                                              Height="10"
                                              RadiusX="1"
                                              RadiusY="1"
                                              Stroke="{TemplateBinding BorderBrush}"
                                              StrokeThickness="{TemplateBinding BorderThickness}"
                                              Fill="#FFFFFFFF"
                                              Margin="1"  /&gt;
                                            &lt;Rectangle
                                              x:Name="BackgroundOverlay"
                                              Fill="#FFC4DBEE"
                                              Opacity="0"
                                              Width="10"
                                              Height="10"
                                              RadiusX="1"
                                              RadiusY="1"
                                              StrokeThickness="1"
                                              Margin="1"
                                              Stroke="#00000000" /&gt;
                                            &lt;Rectangle
                                              x:Name="BoxMiddleBackground"
                                              Width="8"
                                              Height="8"
                                              RadiusX="1"
                                              RadiusY="1"
                                              Fill="{TemplateBinding Background}"
                                              Stroke="#00000000"
                                              StrokeThickness="1" /&gt;
                                            &lt;Rectangle
                                              x:Name="BoxMiddle"
                                              Width="8"
                                              Height="8"
                                              RadiusX="1"
                                              RadiusY="1"
                                              StrokeThickness="1"&gt;
                                                &lt;Rectangle.Stroke&gt;
                                                    &lt;LinearGradientBrush EndPoint=".5,1" StartPoint=".5,0"&gt;
                                                        &lt;GradientStop Color="#FFFFFFFF" Offset="1" /&gt;
                                                        &lt;GradientStop Color="#FFFFFFFF" Offset="0" /&gt;
                                                        &lt;GradientStop Color="#FFFFFFFF" Offset="0.375" /&gt;
                                                        &lt;GradientStop Color="#FFFFFFFF" Offset="0.375" /&gt;
                                                    &lt;/LinearGradientBrush&gt;
                                                &lt;/Rectangle.Stroke&gt;
                                                &lt;Rectangle.Fill&gt;
                                                    &lt;LinearGradientBrush StartPoint="0.62,0.15" EndPoint="0.64,0.88"&gt;
                                                        &lt;GradientStop Color="#FFFFFFFF" Offset="0.013" /&gt;
                                                        &lt;GradientStop Color="#F9FFFFFF" Offset="0.375" /&gt;
                                                        &lt;GradientStop Color="#EAFFFFFF" Offset="0.603" /&gt;
                                                        &lt;GradientStop Color="#D8FFFFFF" Offset="1" /&gt;
                                                    &lt;/LinearGradientBrush&gt;
                                                &lt;/Rectangle.Fill&gt;
                                            &lt;/Rectangle&gt;
                                            &lt;Rectangle
                                              x:Name="BoxMiddleLine"
                                              Width="8"
                                              Height="8"
                                              RadiusX="1"
                                              RadiusY="1"
                                              Stroke="{TemplateBinding BorderBrush}"
                                              StrokeThickness="1"
                                              Opacity=".2" /&gt;
                                            &lt;Rectangle
                                              Height="2"
                                              Width="6"
                                              Fill="#FF666666" /&gt;
                                            &lt;Rectangle
                                              x:Name="UncheckedVisual"
                                              Height="6"
                                              Width="2"
                                              Fill="#FF666666"
                                              Opacity="1" /&gt;
                                            &lt;Rectangle
                                              x:Name="DisabledVisualElement"
                                              RadiusX="1"
                                              RadiusY="1"
                                              Width="10"
                                              Height="10"
                                              Opacity="0"
                                              Fill="#FFFFFFFF" /&gt;
                                        &lt;/Grid&gt;
                                    &lt;/Grid&gt;
                                &lt;/ControlTemplate&gt;
                            &lt;/ToggleButton.Template&gt;
                        &lt;/ToggleButton&gt;
                        
                        &lt;Rectangle
                          x:Name="Selection"
                          Grid.Column="1"
                          Opacity="0"
                          StrokeThickness="1"
                          IsHitTestVisible="False"
                          RadiusX="2"
                          RadiusY="2"&gt;
                            &lt;Rectangle.Fill&gt;
                                &lt;SolidColorBrush x:Name="SelectionFill" Color="#FFBADDE9" /&gt;
                            &lt;/Rectangle.Fill&gt;
                            &lt;Rectangle.Stroke&gt;
                                &lt;SolidColorBrush x:Name="SelectionStroke" Color="#FF6DBDD1" /&gt;
                            &lt;/Rectangle.Stroke&gt;
                        &lt;/Rectangle&gt;
                        &lt;Button
                          x:Name="Header"
                          Grid.Column="1"
                          ClickMode="Hover"
                          Background="{TemplateBinding Background}"
                          Foreground="{TemplateBinding Foreground}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Cursor="{TemplateBinding Cursor}"
                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                          IsTabStop="False"
                          TabNavigation="Once"
                          toolkit:TreeViewConnectingLines.IsHeaderOf="{Binding RelativeSource={RelativeSource TemplatedParent}, Mode=OneTime}"&gt;
                            &lt;Button.Template&gt;
                                &lt;ControlTemplate TargetType="Button"&gt;
                                    &lt;Grid Background="{TemplateBinding Background}"&gt;
                                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                &lt;vsm:VisualState x:Name="Pressed"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Hover"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To=".5" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Content"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To=".55" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                        &lt;Rectangle
                                          x:Name="Hover"
                                          Opacity="0"
                                          Fill="#FFBADDE9"
                                          Stroke="#FF6DBDD1"
                                          StrokeThickness="1"
                                          IsHitTestVisible="False"
                                          RadiusX="2"
                                          RadiusY="2" /&gt;
                                        &lt;ContentPresenter
                                          x:Name="Content"
                                          Cursor="{TemplateBinding Cursor}"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          HorizontalAlignment="Left"
                                          Margin="{TemplateBinding Padding}" /&gt;
                                    &lt;/Grid&gt;
                                &lt;/ControlTemplate&gt;
                            &lt;/Button.Template&gt;
                            &lt;Button.Content&gt;
                                &lt;ContentPresenter
                                  Content="{TemplateBinding Header}"
                                  ContentTemplate="{TemplateBinding HeaderTemplate}" /&gt;
                            &lt;/Button.Content&gt;
                        &lt;/Button&gt;

                        &lt;Border
                          x:Name="Validation"
                          Grid.Column="1"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding ElementName=Header}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;

                        &lt;ItemsPresenter
                          x:Name="ItemsHost"
                          Grid.Row="1"
                          Grid.Column="1"
                          Grid.ColumnSpan="2"
                          Visibility="Collapsed" /&gt;
                    &lt;/Grid&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

&lt;/ResourceDictionary&gt;</sys:String>
    </src:SourceFile.Source>
  </src:SourceFile>
  <src:SourceFile Path="TreeViewCheckBoxes.xaml">
    <src:SourceFile.Source>
      <sys:String xml:space="preserve">&lt;!--
// (c) Copyright Microsoft Corporation.
// This source is subject to the Microsoft Public License (Ms-PL).
// Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
// All other rights reserved.
--&gt;

&lt;ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
  xmlns:toolkit="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
  xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
  xmlns:system="clr-namespace:System;assembly=mscorlib"&gt;

    &lt;ControlTemplate x:Key="CommonValidationToolTipTemplate" TargetType="ToolTip"&gt;
        &lt;Grid
          x:Name="Root"
          Margin="5,0"
          RenderTransformOrigin="0,0"
          Opacity="0"&gt;
            &lt;Grid.RenderTransform&gt;
                &lt;TranslateTransform x:Name="Translation" X="-25" /&gt;
            &lt;/Grid.RenderTransform&gt;
            &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                &lt;vsm:VisualStateGroup Name="OpenStates"&gt;
                    &lt;vsm:VisualStateGroup.Transitions&gt;
                        &lt;vsm:VisualTransition GeneratedDuration="0" /&gt;
                        &lt;vsm:VisualTransition To="Open" GeneratedDuration="0:0:0.2"&gt;
                            &lt;Storyboard&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Translation"
                                  Storyboard.TargetProperty="X"
                                  To="0"
                                  Duration="0:0:0.2"&gt;
                                    &lt;DoubleAnimation.EasingFunction&gt;
                                        &lt;BackEase Amplitude=".3" EasingMode="EaseOut" /&gt;
                                    &lt;/DoubleAnimation.EasingFunction&gt;
                                &lt;/DoubleAnimation&gt;
                                &lt;DoubleAnimation
                                  Storyboard.TargetName="Root"
                                  Storyboard.TargetProperty="Opacity"
                                  To="1"
                                  Duration="0:0:0.2" /&gt;
                            &lt;/Storyboard&gt;
                        &lt;/vsm:VisualTransition&gt;
                    &lt;/vsm:VisualStateGroup.Transitions&gt;
                    &lt;vsm:VisualState x:Name="Closed"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="0"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                    &lt;vsm:VisualState x:Name="Open"&gt;
                        &lt;Storyboard&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Translation"
                              Storyboard.TargetProperty="X"
                              To="0"
                              Duration="0" /&gt;
                            &lt;DoubleAnimation
                              Storyboard.TargetName="Root"
                              Storyboard.TargetProperty="Opacity"
                              To="1"
                              Duration="0" /&gt;
                        &lt;/Storyboard&gt;
                    &lt;/vsm:VisualState&gt;
                &lt;/vsm:VisualStateGroup&gt;
            &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

            &lt;Border Margin="4,4,-4,-4" Background="#052A2E31" CornerRadius="5" /&gt;
            &lt;Border Margin="3,3,-3,-3" Background="#152A2E31" CornerRadius="4" /&gt;
            &lt;Border Margin="2,2,-2,-2" Background="#252A2E31" CornerRadius="3" /&gt;
            &lt;Border Margin="1,1,-1,-1" Background="#352A2E31" CornerRadius="2" /&gt;

            &lt;Border
              Background="#FFDC000C"
              CornerRadius="2"&gt;
                &lt;TextBlock 
                  UseLayoutRounding="false" 
                  Foreground="#FFFFFFFF"
                  Margin="8,4,8,4"
                  MaxWidth="250"
                  TextWrapping="Wrap"
                  Text="{Binding (Validation.Errors)[0].ErrorContent}" /&gt;
            &lt;/Border&gt;
        &lt;/Grid&gt;
    &lt;/ControlTemplate&gt;

    &lt;Style x:Key="CheckBoxTreeView" TargetType="controls:TreeView"&gt;
        &lt;Setter Property="Background" Value="#FFFFFFFF" /&gt;
        &lt;Setter Property="Foreground" Value="#FF000000" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="BorderThickness" Value="1" /&gt;
        &lt;Setter Property="Padding" Value="1" /&gt;
        &lt;Setter Property="BorderBrush" Value="#FF000000" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeView"&gt;
                    &lt;Grid&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="MouseOver" /&gt;
                                &lt;vsm:VisualState x:Name="Pressed" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="FocusStates"&gt;
                                &lt;vsm:VisualState x:Name="Unfocused" /&gt;
                                &lt;vsm:VisualState x:Name="Focused" /&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ValidationStates" &gt;
                                &lt;vsm:VisualState x:Name="Valid" /&gt;
                                &lt;vsm:VisualState x:Name="InvalidUnfocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="InvalidFocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ValidationToolTip"
                                          Storyboard.TargetProperty="IsOpen"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;system:Boolean&gt;True&lt;/system:Boolean&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;

                        &lt;Border
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          CornerRadius="2"&gt;
                            &lt;Border                              
                              Padding="{TemplateBinding Padding}"
                              Background="{TemplateBinding Background}"
                              Margin="1"&gt;
                                &lt;ScrollViewer
                                  x:Name="ScrollViewer"
                                  HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto"
                                  Background="{x:Null}"
                                  BorderBrush="Transparent"
                                  BorderThickness="0"
                                  IsTabStop="False"
                                  TabNavigation="Once"
                                  toolkit:ScrollViewerExtensions.IsMouseWheelScrollingEnabled="True"&gt;
                                    &lt;Grid Background="{TemplateBinding Background}"&gt;
                                        &lt;ItemsPresenter Margin="5" /&gt;
                                    &lt;/Grid&gt;
                                &lt;/ScrollViewer&gt;
                            &lt;/Border&gt;
                        &lt;/Border&gt;

                        &lt;Border
                          x:Name="Validation"
                          Grid.Column="1"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;
                    &lt;/Grid&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

    &lt;Style x:Key="CheckBoxTreeViewItem" TargetType="controls:TreeViewItem"&gt;
        &lt;Setter Property="Padding" Value="3" /&gt;
        &lt;Setter Property="HorizontalContentAlignment" Value="Left" /&gt;
        &lt;Setter Property="VerticalContentAlignment" Value="Top" /&gt;
        &lt;Setter Property="Background" Value="Transparent" /&gt;
        &lt;Setter Property="BorderThickness" Value="1" /&gt;
        &lt;Setter Property="Cursor" Value="Arrow" /&gt;
        &lt;Setter Property="IsTabStop" Value="True" /&gt;
        &lt;Setter Property="TabNavigation" Value="Once" /&gt;
        &lt;Setter Property="Margin" Value="0 1 0 0" /&gt;
        &lt;Setter Property="Template"&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType="controls:TreeViewItem"&gt;
                    &lt;Grid Background="{x:Null}"&gt;
                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                &lt;vsm:VisualState x:Name="MouseOver" /&gt;
                                &lt;vsm:VisualState x:Name="Pressed" /&gt;
                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Header"
                                          Storyboard.TargetProperty="Foreground"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;SolidColorBrush Color="#FF999999" /&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="SelectionStates"&gt;
                                &lt;vsm:VisualState x:Name="Unselected" /&gt;
                                &lt;vsm:VisualState x:Name="Selected"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".75" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="SelectedInactive"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;DoubleAnimation
                                          Storyboard.TargetName="Selection"
                                          Storyboard.TargetProperty="Opacity"
                                          Duration="0"
                                          To=".2" /&gt;
                                        &lt;ColorAnimation
                                          Storyboard.TargetName="SelectionFill"
                                          Storyboard.TargetProperty="Color"
                                          Duration="0"
                                          To="#FF999999" /&gt;
                                        &lt;ColorAnimation
                                          Storyboard.TargetName="SelectionStroke"
                                          Storyboard.TargetProperty="Color"
                                          Duration="0"
                                          To="#FF333333" /&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="HasItemsStates"&gt;
                                &lt;vsm:VisualState x:Name="HasItems" /&gt;
                                &lt;vsm:VisualState x:Name="NoItems"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ExpanderButton"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ExpansionStates"&gt;
                                &lt;vsm:VisualState x:Name="Collapsed" /&gt;
                                &lt;vsm:VisualState x:Name="Expanded"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ItemsHost"
                                          Storyboard.TargetProperty="Visibility"
                                          Duration="0"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                            &lt;vsm:VisualStateGroup x:Name="ValidationStates" &gt;
                                &lt;vsm:VisualState x:Name="Valid" /&gt;
                                &lt;vsm:VisualState x:Name="InvalidUnfocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                                &lt;vsm:VisualState x:Name="InvalidFocused"&gt;
                                    &lt;Storyboard&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="Validation"
                                          Storyboard.TargetProperty="Visibility"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0" Value="Visible" /&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                        &lt;ObjectAnimationUsingKeyFrames
                                          Storyboard.TargetName="ValidationToolTip"
                                          Storyboard.TargetProperty="IsOpen"&gt;
                                            &lt;DiscreteObjectKeyFrame KeyTime="0"&gt;
                                                &lt;DiscreteObjectKeyFrame.Value&gt;
                                                    &lt;system:Boolean&gt;True&lt;/system:Boolean&gt;
                                                &lt;/DiscreteObjectKeyFrame.Value&gt;
                                            &lt;/DiscreteObjectKeyFrame&gt;
                                        &lt;/ObjectAnimationUsingKeyFrames&gt;
                                    &lt;/Storyboard&gt;
                                &lt;/vsm:VisualState&gt;
                            &lt;/vsm:VisualStateGroup&gt;
                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                            &lt;RowDefinition Height="*" /&gt;
                        &lt;/Grid.RowDefinitions&gt;
                        &lt;Grid.ColumnDefinitions&gt;
                            &lt;ColumnDefinition Width="15" /&gt;
                            &lt;ColumnDefinition Width="Auto" /&gt;
                            &lt;ColumnDefinition Width="*" /&gt;
                        &lt;/Grid.ColumnDefinitions&gt;

                        &lt;ToggleButton
                          x:Name="ExpanderButton"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          IsTabStop="False"
                          TabNavigation="Once"&gt;
                            &lt;ToggleButton.Template&gt;
                                &lt;ControlTemplate TargetType="ToggleButton"&gt;
                                    &lt;Grid x:Name="Root" Background="Transparent"&gt;
                                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                &lt;vsm:VisualState x:Name="MouseOver"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;ColorAnimation
                                                          Storyboard.TargetName="UncheckedVisual"
                                                          Storyboard.TargetProperty="(Path.Stroke).Color"
                                                          To="#FF1BBBFA"
                                                          Duration="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Root"
                                                          Storyboard.TargetProperty="Opacity"
                                                          To=".7"
                                                          Duration="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CheckStates"&gt;
                                                &lt;vsm:VisualState x:Name="Unchecked" /&gt;
                                                &lt;vsm:VisualState x:Name="Checked"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="UncheckedVisual"
                                                          Storyboard.TargetProperty="Opacity"
                                                          To="0"
                                                          Duration="0" /&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="CheckedVisual"
                                                          Storyboard.TargetProperty="Opacity"
                                                          To="1"
                                                          Duration="0" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                        &lt;Grid HorizontalAlignment="Right" Margin="2 2 5 2"&gt;
                                            &lt;Path
                                              x:Name="UncheckedVisual"
                                              Width="6"
                                              Height="9"
                                              Fill="#FFFFFFFF"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Right"
                                              Data="M 0,0 L 0,9 L 5,4.5 Z"
                                              StrokeThickness="1"
                                              StrokeLineJoin="Miter"&gt;
                                                &lt;Path.Stroke&gt;
                                                    &lt;SolidColorBrush Color="#FF989898" /&gt;
                                                &lt;/Path.Stroke&gt;
                                            &lt;/Path&gt;
                                            &lt;Path
                                              x:Name="CheckedVisual"
                                              Opacity="0"
                                              Width="6"
                                              Height="6"
                                              Fill="#FF262626"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Center"
                                              Data="M 6,0 L 6,6 L 0,6 Z"
                                              StrokeLineJoin="Miter" /&gt;
                                        &lt;/Grid&gt;
                                    &lt;/Grid&gt;
                                &lt;/ControlTemplate&gt;
                            &lt;/ToggleButton.Template&gt;
                        &lt;/ToggleButton&gt;
                        &lt;Rectangle
                          x:Name="Selection"
                          Grid.Column="1"
                          Opacity="0"
                          StrokeThickness="1"
                          IsHitTestVisible="False"
                          RadiusX="2"
                          RadiusY="2"&gt;
                            &lt;Rectangle.Fill&gt;
                                &lt;SolidColorBrush x:Name="SelectionFill" Color="#FFBADDE9" /&gt;
                            &lt;/Rectangle.Fill&gt;
                            &lt;Rectangle.Stroke&gt;
                                &lt;SolidColorBrush x:Name="SelectionStroke" Color="#FF6DBDD1" /&gt;
                            &lt;/Rectangle.Stroke&gt;
                        &lt;/Rectangle&gt;
                        &lt;Button
                          x:Name="Header"
                          Grid.Column="1"
                          ClickMode="Hover"
                          Background="{TemplateBinding Background}"
                          Foreground="{TemplateBinding Foreground}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Cursor="{TemplateBinding Cursor}"
                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                          IsTabStop="False"
                          TabNavigation="Once"&gt;
                            &lt;Button.Template&gt;
                                &lt;ControlTemplate TargetType="Button"&gt;
                                    &lt;Grid Background="{TemplateBinding Background}"&gt;
                                        &lt;vsm:VisualStateManager.VisualStateGroups&gt;
                                            &lt;vsm:VisualStateGroup x:Name="CommonStates"&gt;
                                                &lt;vsm:VisualState x:Name="Normal" /&gt;
                                                &lt;vsm:VisualState x:Name="Pressed"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Hover"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To=".5" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                                &lt;vsm:VisualState x:Name="Disabled"&gt;
                                                    &lt;Storyboard&gt;
                                                        &lt;DoubleAnimation
                                                          Storyboard.TargetName="Content"
                                                          Storyboard.TargetProperty="Opacity"
                                                          Duration="0"
                                                          To=".55" /&gt;
                                                    &lt;/Storyboard&gt;
                                                &lt;/vsm:VisualState&gt;
                                            &lt;/vsm:VisualStateGroup&gt;
                                        &lt;/vsm:VisualStateManager.VisualStateGroups&gt;
                                        &lt;Rectangle
                                          x:Name="Hover"
                                          Opacity="0"
                                          Fill="#FFBADDE9"
                                          Stroke="#FF6DBDD1"
                                          StrokeThickness="1"
                                          IsHitTestVisible="False"
                                          RadiusX="2"
                                          RadiusY="2" /&gt;
                                        &lt;ContentPresenter
                                          x:Name="Content"
                                          Cursor="{TemplateBinding Cursor}"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          HorizontalAlignment="Left"
                                          Margin="{TemplateBinding Padding}" /&gt;
                                    &lt;/Grid&gt;
                                &lt;/ControlTemplate&gt;
                            &lt;/Button.Template&gt;
                            &lt;Button.Content&gt;
                                &lt;StackPanel Orientation="Horizontal"&gt;
                                    &lt;toolkit:TreeViewItemCheckBox
                                      IsThreeState="False"
                                      Margin="0 0 2 0" /&gt;
                                    &lt;ContentControl
                                      Content="{TemplateBinding Header}"
                                      ContentTemplate="{TemplateBinding HeaderTemplate}" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button.Content&gt;
                        &lt;/Button&gt;

                        &lt;Border
                          x:Name="Validation"
                          Grid.Column="1"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          BorderBrush="#FFDB000C"
                          CornerRadius="2"
                          Visibility="Collapsed"&gt;
                            &lt;ToolTipService.ToolTip&gt;
                                &lt;ToolTip
                                  x:Name="ValidationToolTip"
                                  Template="{StaticResource CommonValidationToolTipTemplate}"
                                  Placement="Right"
                                  PlacementTarget="{Binding ElementName=Header}"
                                  DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                  IsHitTestVisible="True" /&gt;
                            &lt;/ToolTipService.ToolTip&gt;
                            &lt;Grid
                              Width="10"
                              Height="10"
                              HorizontalAlignment="Right"
                              Margin="0,-4,-4,0"
                              VerticalAlignment="Top"
                              Background="Transparent"&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFDC000C" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 Z" /&gt;
                                &lt;Path Margin="-1,3,0,0" Fill="#FFFFFFFF" Data="M 0,0 L2,0 L 8,6 L8,8" /&gt;
                            &lt;/Grid&gt;
                        &lt;/Border&gt;

                        &lt;ItemsPresenter
                          x:Name="ItemsHost"
                          Grid.Row="1"
                          Grid.Column="1"
                          Grid.ColumnSpan="2"
                          Visibility="Collapsed" /&gt;
                    &lt;/Grid&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

&lt;/ResourceDictionary&gt;</sys:String>
    </src:SourceFile.Source>
  </src:SourceFile>
</src:SourceViewer>
    </StackPanel>
</UserControl>